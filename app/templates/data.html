{% extends 'base.html' %}

{% block content %}
<h1>Spotify Data</h1>
<p>First 10 Rows with All Columns of the Dataset</p>
{% if data %}
<div class="table-container">
    <table class="data-table" id="dataTable">
        <thead>
            <tr>
                {% for column in data[0].keys() %}
                <th>{{ column }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>
<div class="pagination-container">
    <button id="prevPage" class="pagination-btn" disabled>Previous</button>
    <span id="pageInfo">Page 1</span>
    <button id="nextPage" class="pagination-btn">Next</button>
</div>
{% else %}
<p>No data available.</p>
{% endif %}

<style>
    .table-container {
        overflow-x: auto;
        margin: 20px 0;
    }

    .data-table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
    }

    .data-table th, .data-table td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
        transition: background-color 0.3s ease;
    }

    .data-table th {
        background-color: #f8f9fa;
        font-weight: bold;
    }

    .data-table tr:hover {
        background-color: #f1f1f1;
    }

    .data-table td:hover {
        background-color: #e9ecef;
    }

    .pagination-container {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-top: 10px;
    }

    .pagination-btn {
        background-color: #007bff;
        color: #fff;
        border: none;
        padding: 8px 12px;
        margin: 0 5px;
        cursor: pointer;
        border-radius: 4px;
        transition: background-color 0.3s ease;
    }

    .pagination-btn:disabled {
        background-color: #6c757d;
        cursor: not-allowed;
    }

    .pagination-btn:hover:not(:disabled) {
        background-color: #0056b3;
    }

    #pageInfo {
        font-size: 16px;
        margin: 0 10px;
    }
</style>

<script>
    const data = {{ data | tojson }};
    const rowsPerPage = 10;
    let currentPage = 1;

    function renderTable() {
        const start = (currentPage - 1) * rowsPerPage;
        const end = start + rowsPerPage;
        const paginatedData = data.slice(start, end);

        const tableBody = document.querySelector('#dataTable tbody');
        tableBody.innerHTML = '';

        paginatedData.forEach(row => {
            const tr = document.createElement('tr');
            for (const value of Object.values(row)) {
                const td = document.createElement('td');
                td.textContent = value;
                tr.appendChild(td);
            }
            tableBody.appendChild(tr);
        });

        document.getElementById('pageInfo').textContent = `Page ${currentPage}`;
        document.getElementById('prevPage').disabled = currentPage === 1;
        document.getElementById('nextPage').disabled = end >= data.length;
    }

    document.getElementById('prevPage').addEventListener('click', () => {
        if (currentPage > 1) {
            currentPage--;
            renderTable();
        }
    });

    document.getElementById('nextPage').addEventListener('click', () => {
        if ((currentPage * rowsPerPage) < data.length) {
            currentPage++;
            renderTable();
        }
    });

    // Initial render
    renderTable();
</script>
{% endblock %}